{"ast":null,"code":"var __jsx = React.createElement;\nimport { useQuery } from 'react-apollo';\nimport React, { useState, useEffect, useRef } from 'react';\nimport { Layout, Card, DataTable } from '@shopify/polaris';\nimport { SEARCH_ORDERS_UPSELL, SEARCH_ORDERS_TOTAL } from '../../server/config/appBasicQuery.js';\n\nfunction fetchDate(d) {\n  const today = new Date();\n  const yesterday = new Date(today);\n  yesterday.setDate(yesterday.getDate() - 1);\n  const lastWeek = new Date(today);\n  lastWeek.setDate(lastWeek.getDate() - 8);\n  var dateArray = {};\n\n  switch (d) {\n    case 'today':\n      dateArray[0] = 'created_at:' + today.getFullYear() + '-' + (today.getMonth() + 1) + '-' + today.getDate();\n      dateArray[1] = today.getFullYear() + '-' + (today.getMonth() + 1) + '-' + today.getDate();\n      return dateArray;\n\n    case 'yesterday':\n      dateArray[0] = 'created_at:' + yesterday.getFullYear() + '-' + (yesterday.getMonth() + 1) + '-' + yesterday.getDate();\n      dateArray[1] = yesterday.getFullYear() + '-' + (yesterday.getMonth() + 1) + '-' + yesterday.getDate();\n      return dateArray;\n\n    case 'lastWeek':\n      dateArray[0] = 'created_at:>=' + lastWeek.getFullYear() + '-' + (lastWeek.getMonth() + 1) + '-' + lastWeek.getDate() + ' created_at:<=' + yesterday.getFullYear() + '-' + (yesterday.getMonth() + 1) + '-' + yesterday.getDate();\n      dateArray[1] = lastWeek.getFullYear() + '-' + (lastWeek.getMonth() + 1) + '-' + lastWeek.getDate() + ' to ' + yesterday.getFullYear() + '-' + (yesterday.getMonth() + 1) + '-' + yesterday.getDate();\n      return dateArray;\n\n    default:\n      dateArray[0] = d;\n      var td = [];\n\n      for (var i = 13; i < d.length;) {\n        if (d[i] === 'c') {\n          td[i - 13] = ' to ';\n          i = i + 13;\n        } else {\n          td[i - 13] = d[i];\n          i++;\n        }\n      }\n\n      dateArray[1] = td;\n      console.log(dateArray);\n      return dateArray;\n  }\n}\n\nfunction SearchOrdersUpsell(dc, d) {\n  const {\n    loading: upsellLoading,\n    error: upsellError,\n    data: upsellData\n  } = useQuery(SEARCH_ORDERS_UPSELL, {\n    variables: {\n      query: d + ' ' + dc\n    }\n  });\n  if (upsellLoading) return 'Loading...';\n  if (upsellError) return `Error! ${upsellError.message}`;\n\n  if (upsellData && upsellData.orders.edges.length != 0 && dc != ' ') {\n    let final = 0;\n\n    for (let i = 0; i < upsellData.orders.edges.length; i++) {\n      final += parseFloat(upsellData.orders.edges[i].node.totalPriceSet.presentmentMoney.amount);\n    }\n\n    return final.toFixed(1);\n  } else return '0';\n}\n\nfunction SearchOrdersTotal(d) {\n  const {\n    loading: totalLoading,\n    error: totalError,\n    data: totalData\n  } = useQuery(SEARCH_ORDERS_TOTAL, {\n    variables: {\n      query: d\n    }\n  });\n  if (totalLoading) return 'Loading...';\n  if (totalError) return `Error! ${totalError.message}`;\n\n  if (totalData && totalData.orders.edges.length != 0) {\n    let final = 0;\n\n    for (let i = 0; i < totalData.orders.edges.length; i++) {\n      final += parseFloat(totalData.orders.edges[i].node.totalPriceSet.presentmentMoney.amount);\n    }\n\n    return final.toFixed(1);\n  } else return '0';\n}\n\nfunction Percentage(x, y) {\n  const percentage = x / y * 100 + '%';\n  if (percentage != 'NaN%') return percentage;else return '0';\n}\n\nfunction DisplayOrders({\n  valueCODE\n}) {\n  const date = fetchDate(valueCODE.date)[0];\n  const upsellPirce = SearchOrdersUpsell(valueCODE.coupon, date);\n  const totalPrice = SearchOrdersTotal(date);\n  const rows = [[fetchDate(valueCODE.date)[1], upsellPirce, totalPrice, Percentage(upsellPirce, totalPrice)]];\n  return __jsx(DataTable, {\n    columnContentTypes: ['text', 'numeric', 'numeric', 'text'],\n    headings: ['Date', 'Upsell(with discount) Sale', 'Total Sale', 'Percentage'],\n    rows: rows\n  });\n}\n\nexport default DisplayOrders;","map":{"version":3,"sources":["C:/Users/molek/OneDrive/Desktop/Work/Magic-Upsell/client/components/DisplayOrders.js"],"names":["useQuery","React","useState","useEffect","useRef","Layout","Card","DataTable","SEARCH_ORDERS_UPSELL","SEARCH_ORDERS_TOTAL","fetchDate","d","today","Date","yesterday","setDate","getDate","lastWeek","dateArray","getFullYear","getMonth","td","i","length","console","log","SearchOrdersUpsell","dc","loading","upsellLoading","error","upsellError","data","upsellData","variables","query","message","orders","edges","final","parseFloat","node","totalPriceSet","presentmentMoney","amount","toFixed","SearchOrdersTotal","totalLoading","totalError","totalData","Percentage","x","y","percentage","DisplayOrders","valueCODE","date","upsellPirce","coupon","totalPrice","rows"],"mappings":"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","sourcesContent":["import { useQuery } from 'react-apollo';\r\nimport React, { useState,useEffect,useRef } from 'react';\r\nimport {\r\n  Layout,\r\n  Card,\r\n  DataTable,\r\n} from '@shopify/polaris';\r\nimport {SEARCH_ORDERS_UPSELL,SEARCH_ORDERS_TOTAL} from '../../server/config/appBasicQuery.js';\r\n\r\nfunction fetchDate(d) {\r\n  const today = new Date();\r\n  const yesterday = new Date(today);\r\n  yesterday.setDate(yesterday.getDate() - 1);\r\n  const lastWeek = new Date(today);\r\n  lastWeek.setDate(lastWeek.getDate() - 8);\r\n  var dateArray = {};\r\n  switch(d) {\r\n    case 'today':\r\n      dateArray[0] = 'created_at:'+today.getFullYear()+'-'+(today.getMonth()+1)+'-'+today.getDate();\r\n      dateArray[1] = today.getFullYear()+'-'+(today.getMonth()+1)+'-'+today.getDate();\r\n      return dateArray;\r\n    case 'yesterday':\r\n      dateArray[0] = 'created_at:'+yesterday.getFullYear()+'-'+(yesterday.getMonth()+1)+'-'+yesterday.getDate();\r\n      dateArray[1] = yesterday.getFullYear()+'-'+(yesterday.getMonth()+1)+'-'+yesterday.getDate();\r\n      return dateArray;\r\n    case 'lastWeek':\r\n      dateArray[0] = 'created_at:>='+lastWeek.getFullYear()+'-'+(lastWeek.getMonth()+1)+'-'+lastWeek.getDate()+' created_at:<='+yesterday.getFullYear()+'-'+(yesterday.getMonth()+1)+'-'+yesterday.getDate();\r\n      dateArray[1] = lastWeek.getFullYear()+'-'+(lastWeek.getMonth()+1)+'-'+lastWeek.getDate()+' to '+yesterday.getFullYear()+'-'+(yesterday.getMonth()+1)+'-'+yesterday.getDate();\r\n      return dateArray;\r\n    default:\r\n      dateArray[0] = d;\r\n      var td = [];\r\n      for(var i = 13; i < d.length;) {\r\n        if(d[i]==='c') {\r\n          td[i-13] = ' to ';\r\n          i = i+13;\r\n        }\r\n        else{td[i-13] = d[i];i++;}\r\n      }\r\n      dateArray[1] = td;\r\nconsole.log(dateArray);\r\n      return dateArray;\r\n  }\r\n}\r\n\r\nfunction SearchOrdersUpsell (dc,d) {\r\n  const { loading:upsellLoading, error:upsellError, data:upsellData } = useQuery(SEARCH_ORDERS_UPSELL,{\r\n    variables:{query:d+' '+dc}\r\n  });\r\n  if (upsellLoading) return 'Loading...';\r\n  if (upsellError) return `Error! ${upsellError.message}`;\r\n  if (upsellData && upsellData.orders.edges.length!=0 && dc!=' ') {\r\nlet final = 0;\r\nfor(let i =0;i<upsellData.orders.edges.length;i++){final+=parseFloat(upsellData.orders.edges[i].node.totalPriceSet.presentmentMoney.amount);}\r\nreturn final.toFixed(1);\r\n}\r\n  else return '0';\r\n}\r\n\r\nfunction SearchOrdersTotal(d) {\r\n  const { loading:totalLoading, error:totalError, data:totalData } = useQuery(SEARCH_ORDERS_TOTAL,{\r\n    variables:{query:d}\r\n  });\r\n  if (totalLoading) return 'Loading...';\r\n  if (totalError) return `Error! ${totalError.message}`;\r\n  if (totalData && totalData.orders.edges.length!=0) {\r\nlet final = 0;\r\nfor(let i =0;i<totalData.orders.edges.length;i++){final+=parseFloat(totalData.orders.edges[i].node.totalPriceSet.presentmentMoney.amount);}\r\nreturn final.toFixed(1);\r\n}\r\n  else return '0';\r\n}\r\n\r\nfunction Percentage(x,y) {\r\n  const percentage = x/y*100+'%';\r\n  if(percentage != 'NaN%') return percentage;\r\n  else return '0';\r\n}\r\n\r\nfunction DisplayOrders({valueCODE}) {\r\n  const date = fetchDate(valueCODE.date)[0];\r\n  const upsellPirce = SearchOrdersUpsell(valueCODE.coupon,date);\r\n  const totalPrice = SearchOrdersTotal(date);\r\n  const rows = [[fetchDate(valueCODE.date)[1], upsellPirce, totalPrice, Percentage(upsellPirce,totalPrice)]];\r\n\r\n  return (\r\n    <DataTable\r\n          columnContentTypes={[\r\n            'text',\r\n            'numeric',\r\n            'numeric',\r\n            'text',\r\n          ]}\r\n          headings={[\r\n            'Date',\r\n            'Upsell(with discount) Sale',\r\n            'Total Sale',\r\n            'Percentage',\r\n          ]}\r\n          rows={rows}\r\n        />\r\n  );\r\n}\r\n\r\n\r\nexport default DisplayOrders;\r\n"]},"metadata":{},"sourceType":"module"}