{"ast":null,"code":"var __jsx = React.createElement;\nimport React, { useState, useEffect, useRef, useContext, useCallback } from 'react';\nimport { Toast, Button, Modal, TextContainer } from '@shopify/polaris';\nimport { useQuery, useMutation } from 'react-apollo';\nimport axios from 'axios';\nimport { DELETE_SCRIPT } from '../../server/config/appBasicQuery.js';\n\nconst config = require('../../server/config/httpConfig.js');\n\nfunction DeleteScript(props) {\n  const isInitialMount = useRef(true);\n  const {\n    0: showToast,\n    1: setToast\n  } = useState(false);\n  const {\n    0: refresh,\n    1: setRefresh\n  } = useState(false);\n  const {\n    0: active,\n    1: setActive\n  } = useState(false);\n  const {\n    0: message,\n    1: setMessage\n  } = useState();\n  const {\n    0: scriptID,\n    1: setScriptID\n  } = useState();\n  const {\n    0: status,\n    1: setStatus\n  } = useState(true);\n\n  const toggleToast = () => setToast(!showToast);\n\n  const toastMarkup = showToast ? __jsx(Toast, {\n    content: message,\n    onDismiss: toggleToast,\n    Diduration: 1500\n  }) : null;\n  const [handleSubmit, {\n    error: discountError,\n    data: discountData\n  }] = useMutation(DELETE_SCRIPT);\n  const handleChange = useCallback(() => setActive(!active), [active]);\n  useEffect(() => {\n    async function getData() {\n      const search_data = {\n        search: props.valueID\n      };\n      await axios.post(config.HTTP_API + '/store/search/scriptID', search_data).then(res => {\n        setScriptID(res.data[0].script_id);\n        res.data[0].script_id ? setStatus(false) : setStatus(true);\n      });\n    }\n\n    async function fetchData() {\n      if (isInitialMount.current && props) {\n        isInitialMount.current = false;\n        await getData();\n      }\n\n      if (refresh) {\n        await getData();\n        setRefresh(false);\n      }\n    }\n\n    fetchData();\n  });\n  return __jsx(\"div\", null, toastMarkup, __jsx(Button, {\n    destructive: true,\n    disabled: status,\n    onClick: handleChange\n  }, \"Disable\"), __jsx(Modal, {\n    open: active,\n    onClose: handleChange,\n    title: \"Pause all the functions\",\n    secondaryActions: {\n      content: 'Cancel',\n      onAction: handleChange\n    },\n    primaryAction: {\n      content: 'Disable',\n      onAction: () => {\n        handleSubmit({\n          variables: {\n            id: config.CombineId(scriptID)\n          }\n        }).then(async ({\n          data\n        }) => {\n          handleChange();\n          setMessage('Successfully Disabled!');\n          toggleToast();\n          const delete_data = {\n            script_id: '',\n            upsell_mode: ''\n          };\n          await axios.put(config.HTTP_API + '/store/' + props.valueID, delete_data).then(result => {\n            setStatus(true);\n            setRefresh(true);\n            props.handleRefresh();\n          });\n        });\n      }\n    }\n  }, __jsx(Modal.Section, null, __jsx(TextContainer, null, __jsx(\"p\", null, \"Your data will be stored, you can activate the upsell back at anytime or switch to another upsell mode.\")))));\n}\n\nexport default DeleteScript;","map":{"version":3,"sources":["C:/Users/molek/OneDrive/Desktop/Work/Magic-Upsell/client/components/DeleteScript.js"],"names":["React","useState","useEffect","useRef","useContext","useCallback","Toast","Button","Modal","TextContainer","useQuery","useMutation","axios","DELETE_SCRIPT","config","require","DeleteScript","props","isInitialMount","showToast","setToast","refresh","setRefresh","active","setActive","message","setMessage","scriptID","setScriptID","status","setStatus","toggleToast","toastMarkup","handleSubmit","error","discountError","data","discountData","handleChange","getData","search_data","search","valueID","post","HTTP_API","then","res","script_id","fetchData","current","content","onAction","variables","id","CombineId","delete_data","upsell_mode","put","result","handleRefresh"],"mappings":"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","sourcesContent":["import React, { useState,useEffect,useRef,useContext,useCallback } from 'react';\r\nimport {\r\n  Toast,\r\n  Button,\r\n  Modal,\r\n  TextContainer\r\n} from '@shopify/polaris';\r\nimport { useQuery,useMutation } from 'react-apollo';\r\nimport axios from 'axios';\r\nimport {DELETE_SCRIPT} from '../../server/config/appBasicQuery.js';\r\nconst config = require('../../server/config/httpConfig.js');\r\n\r\nfunction DeleteScript(props) {\r\n  const isInitialMount = useRef(true);\r\n  const [showToast, setToast] = useState(false);\r\n  const [refresh, setRefresh] = useState(false);\r\n  const [active, setActive] = useState(false);\r\n  const [message, setMessage] = useState();\r\n  const [scriptID, setScriptID] = useState();\r\n  const [status, setStatus] = useState(true);\r\n  const toggleToast = () => setToast(!showToast);\r\n  const toastMarkup = showToast ? (\r\n        <Toast content={message} onDismiss={toggleToast} Diduration={1500} />\r\n    ) : null;\r\n  const [handleSubmit,{error:discountError, data:discountData}] = useMutation(DELETE_SCRIPT);\r\n  const handleChange = useCallback(() => setActive(!active), [active]);\r\n\r\n  useEffect(() => {\r\n    async function getData() {\r\n      const search_data = {search:props.valueID};\r\n      await axios.post(config.HTTP_API + '/store/search/scriptID', search_data).then((res) => {\r\n        setScriptID(res.data[0].script_id);\r\n        res.data[0].script_id ? setStatus(false) : setStatus(true);\r\n      });\r\n    }\r\n    async function fetchData(){\r\n      if (isInitialMount.current && props) {\r\n        isInitialMount.current = false;\r\n        await getData();\r\n      }\r\n      if(refresh) {\r\n        await getData();\r\n        setRefresh(false);\r\n      }\r\n    }\r\n    fetchData();\r\n  });\r\n\r\n  return (\r\n    <div>\r\n      {toastMarkup}\r\n      <Button\r\n      destructive\r\n      disabled={status}\r\n      onClick={handleChange}>Disable</Button>\r\n\r\n      <Modal\r\n      open={active}\r\n      onClose={handleChange}\r\n      title=\"Pause all the functions\"\r\n      secondaryActions={{\r\n        content:'Cancel',\r\n        onAction: handleChange,\r\n      }}\r\n      primaryAction={{\r\n        content:'Disable',\r\n        onAction: () => {\r\n          handleSubmit({\r\n            variables:{\r\n              id: config.CombineId(scriptID)\r\n            }\r\n          }).then(async ({data})=>{\r\n            handleChange();\r\n            setMessage('Successfully Disabled!');\r\n            toggleToast();\r\n            const delete_data = {script_id:'',upsell_mode:''};\r\n            await axios.put(config.HTTP_API + '/store/' + props.valueID, delete_data).then(result=>{\r\n              setStatus(true);\r\n              setRefresh(true);\r\n\t\tprops.handleRefresh();\r\n            });\r\n          });\r\n        }\r\n      }}\r\n      >\r\n      <Modal.Section>\r\n        <TextContainer>\r\n          <p>Your data will be stored, you can activate the upsell back at anytime or switch to another upsell mode.</p>\r\n        </TextContainer>\r\n      </Modal.Section>\r\n      </Modal>\r\n    </div>\r\n  )\r\n}\r\nexport default DeleteScript;\r\n"]},"metadata":{},"sourceType":"module"}