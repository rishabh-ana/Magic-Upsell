{"ast":null,"code":"import _regeneratorRuntime from \"@babel/runtime/regenerator\";\nimport _asyncToGenerator from \"@babel/runtime/helpers/esm/asyncToGenerator\";\nimport _slicedToArray from \"@babel/runtime/helpers/esm/slicedToArray\";\n\nvar _s = $RefreshSig$();\n\nvar __jsx = React.createElement;\nimport React, { useState, useRef, useEffect } from 'react';\nimport { Toast, Button } from '@shopify/polaris';\nimport { useMutation } from 'react-apollo';\nimport axios from 'axios';\nimport { CREATE_SCRIPT } from '../../server/config/appBasicQuery.js';\n\nvar config = require('../../server/config/httpConfig.js');\n\nfunction getUrl(s) {\n  switch (s) {\n    case 'dynamic':\n      return 'https://cdn.shopify.com/s/files/1/0313/1447/7188/files/MagicD-v7.js?v=1600115933';\n\n    case 'manual':\n      return 'https://cdn.shopify.com/s/files/1/0313/1447/7188/files/MagicM-v7.js?v=1600115933';\n\n    default:\n      null;\n  }\n}\n\nfunction CreateScript(props) {\n  _s();\n\n  var isInitialMount = useRef(true);\n\n  var _useState = useState(false),\n      showToast = _useState[0],\n      setToast = _useState[1];\n\n  var _useState2 = useState(),\n      message = _useState2[0],\n      setMessage = _useState2[1];\n\n  var _useMutation = useMutation(CREATE_SCRIPT),\n      _useMutation2 = _slicedToArray(_useMutation, 2),\n      handleSubmit = _useMutation2[0],\n      _useMutation2$ = _useMutation2[1],\n      discountError = _useMutation2$.error,\n      discountData = _useMutation2$.data;\n\n  var _useState3 = useState(false),\n      refresh = _useState3[0],\n      setRefresh = _useState3[1];\n\n  var toggleToast = function toggleToast() {\n    return setToast(!showToast);\n  };\n\n  var toastMarkup = showToast ? __jsx(Toast, {\n    content: message,\n    onDismiss: toggleToast,\n    Diduration: 1500\n  }) : null;\n\n  var _useState4 = useState(true),\n      pending = _useState4[0],\n      setPending = _useState4[1];\n\n  useEffect(function () {\n    if (isInitialMount.current && props) {\n      setPending(false);\n      isInitialMount.current = false;\n      console.log('sss', props);\n    }\n  });\n  return __jsx(React.Fragment, null, !pending ? __jsx(\"div\", null, toastMarkup, __jsx(Button, {\n    disabled: !props.manual[2],\n    primary: true,\n    onClick: function onClick() {\n      handleSubmit({\n        variables: {\n          input: {\n            displayScope: 'ORDER_STATUS',\n            src: getUrl(props.manual[1])\n          }\n        }\n      }).then( /*#__PURE__*/function () {\n        var _ref2 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee(_ref) {\n          var data, db_data;\n          return _regeneratorRuntime.wrap(function _callee$(_context) {\n            while (1) {\n              switch (_context.prev = _context.next) {\n                case 0:\n                  data = _ref.data;\n                  setMessage('Successfully Installed!');\n                  toggleToast();\n                  db_data = {\n                    script_id: config.ExtractId(data.scriptTagCreate.scriptTag.id),\n                    upsell_mode: props.manual[1]\n                  };\n                  _context.next = 6;\n                  return axios.put(config.HTTP_API + '/store/' + props.valueID, db_data);\n\n                case 6:\n                  props.handleRefresh();\n\n                case 7:\n                case \"end\":\n                  return _context.stop();\n              }\n            }\n          }, _callee);\n        }));\n\n        return function (_x) {\n          return _ref2.apply(this, arguments);\n        };\n      }());\n    }\n  }, \"Activate\")) : null);\n}\n\n_s(CreateScript, \"dAZits5r+cqN79YY43nLVUmY/9M=\", false, function () {\n  return [useMutation];\n});\n\n_c = CreateScript;\nexport default CreateScript;\n\nvar _c;\n\n$RefreshReg$(_c, \"CreateScript\");","map":{"version":3,"sources":["C:/Users/molek/OneDrive/Desktop/Work/Magic-Upsell/client/components/CreateScript.js"],"names":["React","useState","useRef","useEffect","Toast","Button","useMutation","axios","CREATE_SCRIPT","config","require","getUrl","s","CreateScript","props","isInitialMount","showToast","setToast","message","setMessage","handleSubmit","discountError","error","discountData","data","refresh","setRefresh","toggleToast","toastMarkup","pending","setPending","current","console","log","manual","variables","input","displayScope","src","then","db_data","script_id","ExtractId","scriptTagCreate","scriptTag","id","upsell_mode","put","HTTP_API","valueID","handleRefresh"],"mappings":"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","sourcesContent":["import React, { useState,useRef,useEffect} from 'react';\r\nimport {\r\n  Toast,\r\n  Button,\r\n} from '@shopify/polaris';\r\nimport { useMutation } from 'react-apollo';\r\nimport axios from 'axios';\r\nimport {CREATE_SCRIPT} from '../../server/config/appBasicQuery.js';\r\nconst config = require('../../server/config/httpConfig.js');\r\n\r\nfunction getUrl(s) {\r\n  switch (s) {\r\n    case 'dynamic': return 'https://cdn.shopify.com/s/files/1/0313/1447/7188/files/MagicD-v7.js?v=1600115933';\r\n    case 'manual': return 'https://cdn.shopify.com/s/files/1/0313/1447/7188/files/MagicM-v7.js?v=1600115933';\r\n    default: null;\r\n  }\r\n}\r\n\r\nfunction CreateScript(props) {\r\n  const isInitialMount = useRef(true);\r\n  const [showToast, setToast] = useState(false);\r\n  const [message, setMessage] = useState();\r\n  const [handleSubmit,{error:discountError, data:discountData}] = useMutation(CREATE_SCRIPT);\r\n  const [refresh, setRefresh] = useState(false);\r\n  const toggleToast = () => setToast(!showToast);\r\n  const toastMarkup = showToast ? (\r\n        <Toast content={message} onDismiss={toggleToast} Diduration={1500} />\r\n    ) : null;\r\n  const [pending, setPending] = useState(true);\r\n\r\nuseEffect(() => {\r\nif (isInitialMount.current && props) {\r\n        setPending(false);\r\nisInitialMount.current = false;\r\nconsole.log('sss',props)\r\n      }\r\n\r\n});\r\n\r\n  return (\r\n<>\r\n{!pending ?\r\n    <div>\r\n      {toastMarkup}\r\n      <Button\r\n      disabled={!props.manual[2]}\r\n      primary\r\n      onClick = {() => {\r\n        handleSubmit({\r\n          variables:{\r\n            input:{\r\n              displayScope: 'ORDER_STATUS',\r\n              src:getUrl(props.manual[1])\r\n            }\r\n          }\r\n        }).then(async ({data})=>{\r\n          setMessage('Successfully Installed!');\r\n          toggleToast();\r\n          const db_data = {script_id: config.ExtractId(data.scriptTagCreate.scriptTag.id),upsell_mode:props.manual[1]};\r\n          await axios.put(config.HTTP_API + '/store/' + props.valueID, db_data);\r\n          props.handleRefresh();\r\n        });\r\n      }}>Activate</Button>\r\n    </div>\r\n:\r\nnull\r\n}\r\n</>\r\n  );\r\n}\r\nexport default CreateScript;\r\n"]},"metadata":{},"sourceType":"module"}