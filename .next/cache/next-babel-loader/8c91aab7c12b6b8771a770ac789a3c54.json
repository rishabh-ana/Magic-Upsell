{"ast":null,"code":"import _regeneratorRuntime from \"@babel/runtime/regenerator\";\nimport _asyncToGenerator from \"@babel/runtime/helpers/esm/asyncToGenerator\";\nimport _slicedToArray from \"@babel/runtime/helpers/esm/slicedToArray\";\n\nvar _s = $RefreshSig$();\n\nvar __jsx = React.createElement;\nimport React, { useState, useEffect, useRef, useContext, useCallback } from 'react';\nimport { Toast, Button, Modal, TextContainer } from '@shopify/polaris';\nimport { useQuery, useMutation } from 'react-apollo';\nimport axios from 'axios';\nimport { DELETE_SCRIPT } from '../../server/config/appBasicQuery.js';\n\nvar config = require('../../server/config/httpConfig.js');\n\nfunction DeleteScript(props) {\n  _s();\n\n  var isInitialMount = useRef(true);\n\n  var _useState = useState(false),\n      showToast = _useState[0],\n      setToast = _useState[1];\n\n  var _useState2 = useState(false),\n      refresh = _useState2[0],\n      setRefresh = _useState2[1];\n\n  var _useState3 = useState(false),\n      active = _useState3[0],\n      setActive = _useState3[1];\n\n  var _useState4 = useState(),\n      message = _useState4[0],\n      setMessage = _useState4[1];\n\n  var _useState5 = useState(),\n      scriptID = _useState5[0],\n      setScriptID = _useState5[1];\n\n  var _useState6 = useState(true),\n      status = _useState6[0],\n      setStatus = _useState6[1];\n\n  var toggleToast = function toggleToast() {\n    return setToast(!showToast);\n  };\n\n  var toastMarkup = showToast ? __jsx(Toast, {\n    content: message,\n    onDismiss: toggleToast,\n    Diduration: 1500\n  }) : null;\n\n  var _useMutation = useMutation(DELETE_SCRIPT),\n      _useMutation2 = _slicedToArray(_useMutation, 2),\n      handleSubmit = _useMutation2[0],\n      _useMutation2$ = _useMutation2[1],\n      discountError = _useMutation2$.error,\n      discountData = _useMutation2$.data;\n\n  var handleChange = useCallback(function () {\n    return setActive(!active);\n  }, [active]);\n  useEffect(function () {\n    function getData() {\n      return _getData.apply(this, arguments);\n    }\n\n    function _getData() {\n      _getData = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee() {\n        var search_data;\n        return _regeneratorRuntime.wrap(function _callee$(_context) {\n          while (1) {\n            switch (_context.prev = _context.next) {\n              case 0:\n                search_data = {\n                  search: props.valueID\n                };\n                _context.next = 3;\n                return axios.post(config.HTTP_API + '/store/search/scriptID', search_data).then(function (res) {\n                  setScriptID(res.data[0].script_id);\n                  res.data[0].script_id ? setStatus(false) : setStatus(true);\n                });\n\n              case 3:\n              case \"end\":\n                return _context.stop();\n            }\n          }\n        }, _callee);\n      }));\n      return _getData.apply(this, arguments);\n    }\n\n    function fetchData() {\n      return _fetchData.apply(this, arguments);\n    }\n\n    function _fetchData() {\n      _fetchData = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee2() {\n        return _regeneratorRuntime.wrap(function _callee2$(_context2) {\n          while (1) {\n            switch (_context2.prev = _context2.next) {\n              case 0:\n                if (!(isInitialMount.current && props)) {\n                  _context2.next = 4;\n                  break;\n                }\n\n                isInitialMount.current = false;\n                _context2.next = 4;\n                return getData();\n\n              case 4:\n                if (!refresh) {\n                  _context2.next = 8;\n                  break;\n                }\n\n                _context2.next = 7;\n                return getData();\n\n              case 7:\n                setRefresh(false);\n\n              case 8:\n              case \"end\":\n                return _context2.stop();\n            }\n          }\n        }, _callee2);\n      }));\n      return _fetchData.apply(this, arguments);\n    }\n\n    fetchData();\n  });\n  return __jsx(\"div\", null, toastMarkup, __jsx(Button, {\n    destructive: true,\n    disabled: status,\n    onClick: handleChange\n  }, \"Disable\"), __jsx(Modal, {\n    open: active,\n    onClose: handleChange,\n    title: \"Pause all the functions\",\n    secondaryActions: {\n      content: 'Cancel',\n      onAction: handleChange\n    },\n    primaryAction: {\n      content: 'Disable',\n      onAction: function onAction() {\n        handleSubmit({\n          variables: {\n            id: config.CombineId(scriptID)\n          }\n        }).then( /*#__PURE__*/function () {\n          var _ref2 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee3(_ref) {\n            var data, delete_data;\n            return _regeneratorRuntime.wrap(function _callee3$(_context3) {\n              while (1) {\n                switch (_context3.prev = _context3.next) {\n                  case 0:\n                    data = _ref.data;\n                    handleChange();\n                    setMessage('Successfully Disabled!');\n                    toggleToast();\n                    delete_data = {\n                      script_id: '',\n                      upsell_mode: ''\n                    };\n                    _context3.next = 7;\n                    return axios.put(config.HTTP_API + '/store/' + props.valueID, delete_data).then(function (result) {\n                      setStatus(true);\n                      setRefresh(true);\n                      props.handleRefresh();\n                    });\n\n                  case 7:\n                  case \"end\":\n                    return _context3.stop();\n                }\n              }\n            }, _callee3);\n          }));\n\n          return function (_x) {\n            return _ref2.apply(this, arguments);\n          };\n        }());\n      }\n    }\n  }, __jsx(Modal.Section, null, __jsx(TextContainer, null, __jsx(\"p\", null, \"Your data will be stored, you can activate the upsell back at anytime or switch to another upsell mode.\")))));\n}\n\n_s(DeleteScript, \"8Yuo7kRSdKrxW9r8FnA/ECfZzBk=\", false, function () {\n  return [useMutation];\n});\n\n_c = DeleteScript;\nexport default DeleteScript;\n\nvar _c;\n\n$RefreshReg$(_c, \"DeleteScript\");","map":{"version":3,"sources":["C:/Users/molek/OneDrive/Desktop/Work/Magic-Upsell/client/components/DeleteScript.js"],"names":["React","useState","useEffect","useRef","useContext","useCallback","Toast","Button","Modal","TextContainer","useQuery","useMutation","axios","DELETE_SCRIPT","config","require","DeleteScript","props","isInitialMount","showToast","setToast","refresh","setRefresh","active","setActive","message","setMessage","scriptID","setScriptID","status","setStatus","toggleToast","toastMarkup","handleSubmit","discountError","error","discountData","data","handleChange","getData","search_data","search","valueID","post","HTTP_API","then","res","script_id","fetchData","current","content","onAction","variables","id","CombineId","delete_data","upsell_mode","put","result","handleRefresh"],"mappings":"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","sourcesContent":["import React, { useState,useEffect,useRef,useContext,useCallback } from 'react';\r\nimport {\r\n  Toast,\r\n  Button,\r\n  Modal,\r\n  TextContainer\r\n} from '@shopify/polaris';\r\nimport { useQuery,useMutation } from 'react-apollo';\r\nimport axios from 'axios';\r\nimport {DELETE_SCRIPT} from '../../server/config/appBasicQuery.js';\r\nconst config = require('../../server/config/httpConfig.js');\r\n\r\nfunction DeleteScript(props) {\r\n  const isInitialMount = useRef(true);\r\n  const [showToast, setToast] = useState(false);\r\n  const [refresh, setRefresh] = useState(false);\r\n  const [active, setActive] = useState(false);\r\n  const [message, setMessage] = useState();\r\n  const [scriptID, setScriptID] = useState();\r\n  const [status, setStatus] = useState(true);\r\n  const toggleToast = () => setToast(!showToast);\r\n  const toastMarkup = showToast ? (\r\n        <Toast content={message} onDismiss={toggleToast} Diduration={1500} />\r\n    ) : null;\r\n  const [handleSubmit,{error:discountError, data:discountData}] = useMutation(DELETE_SCRIPT);\r\n  const handleChange = useCallback(() => setActive(!active), [active]);\r\n\r\n  useEffect(() => {\r\n    async function getData() {\r\n      const search_data = {search:props.valueID};\r\n      await axios.post(config.HTTP_API + '/store/search/scriptID', search_data).then((res) => {\r\n        setScriptID(res.data[0].script_id);\r\n        res.data[0].script_id ? setStatus(false) : setStatus(true);\r\n      });\r\n    }\r\n    async function fetchData(){\r\n      if (isInitialMount.current && props) {\r\n        isInitialMount.current = false;\r\n        await getData();\r\n      }\r\n      if(refresh) {\r\n        await getData();\r\n        setRefresh(false);\r\n      }\r\n    }\r\n    fetchData();\r\n  });\r\n\r\n  return (\r\n    <div>\r\n      {toastMarkup}\r\n      <Button\r\n      destructive\r\n      disabled={status}\r\n      onClick={handleChange}>Disable</Button>\r\n\r\n      <Modal\r\n      open={active}\r\n      onClose={handleChange}\r\n      title=\"Pause all the functions\"\r\n      secondaryActions={{\r\n        content:'Cancel',\r\n        onAction: handleChange,\r\n      }}\r\n      primaryAction={{\r\n        content:'Disable',\r\n        onAction: () => {\r\n          handleSubmit({\r\n            variables:{\r\n              id: config.CombineId(scriptID)\r\n            }\r\n          }).then(async ({data})=>{\r\n            handleChange();\r\n            setMessage('Successfully Disabled!');\r\n            toggleToast();\r\n            const delete_data = {script_id:'',upsell_mode:''};\r\n            await axios.put(config.HTTP_API + '/store/' + props.valueID, delete_data).then(result=>{\r\n              setStatus(true);\r\n              setRefresh(true);\r\n\t\tprops.handleRefresh();\r\n            });\r\n          });\r\n        }\r\n      }}\r\n      >\r\n      <Modal.Section>\r\n        <TextContainer>\r\n          <p>Your data will be stored, you can activate the upsell back at anytime or switch to another upsell mode.</p>\r\n        </TextContainer>\r\n      </Modal.Section>\r\n      </Modal>\r\n    </div>\r\n  )\r\n}\r\nexport default DeleteScript;\r\n"]},"metadata":{},"sourceType":"module"}