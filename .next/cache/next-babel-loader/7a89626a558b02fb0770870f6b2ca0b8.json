{"ast":null,"code":"var __jsx = React.createElement;\nimport React, { useState, useRef, useEffect } from 'react';\nimport { Toast, Button } from '@shopify/polaris';\nimport { useMutation } from 'react-apollo';\nimport axios from 'axios';\nimport { CREATE_SCRIPT } from '../../server/config/appBasicQuery.js';\n\nconst config = require('../../server/config/httpConfig.js');\n\nfunction getUrl(s) {\n  switch (s) {\n    case 'dynamic':\n      return 'https://cdn.shopify.com/s/files/1/0313/1447/7188/files/MagicD-v7.js?v=1600115933';\n\n    case 'manual':\n      return 'https://cdn.shopify.com/s/files/1/0313/1447/7188/files/MagicM-v7.js?v=1600115933';\n\n    default:\n      null;\n  }\n}\n\nfunction CreateScript(props) {\n  const isInitialMount = useRef(true);\n  const {\n    0: showToast,\n    1: setToast\n  } = useState(false);\n  const {\n    0: message,\n    1: setMessage\n  } = useState();\n  const [handleSubmit, {\n    error: discountError,\n    data: discountData\n  }] = useMutation(CREATE_SCRIPT);\n  const {\n    0: refresh,\n    1: setRefresh\n  } = useState(false);\n\n  const toggleToast = () => setToast(!showToast);\n\n  const toastMarkup = showToast ? __jsx(Toast, {\n    content: message,\n    onDismiss: toggleToast,\n    Diduration: 1500\n  }) : null;\n  const {\n    0: pending,\n    1: setPending\n  } = useState(true);\n  useEffect(() => {\n    if (isInitialMount.current && props) {\n      setPending(false);\n      isInitialMount.current = false;\n      console.log('sss', props);\n    }\n  });\n  return __jsx(React.Fragment, null, !pending ? __jsx(\"div\", null, toastMarkup, __jsx(Button, {\n    disabled: !props.manual[2],\n    primary: true,\n    onClick: () => {\n      handleSubmit({\n        variables: {\n          input: {\n            displayScope: 'ORDER_STATUS',\n            src: getUrl(props.manual[1])\n          }\n        }\n      }).then(async ({\n        data\n      }) => {\n        setMessage('Successfully Installed!');\n        toggleToast();\n        const db_data = {\n          script_id: config.ExtractId(data.scriptTagCreate.scriptTag.id),\n          upsell_mode: props.manual[1]\n        };\n        await axios.put(config.HTTP_API + '/store/' + props.valueID, db_data);\n        props.handleRefresh();\n      });\n    }\n  }, \"Activate\")) : null);\n}\n\nexport default CreateScript;","map":{"version":3,"sources":["C:/Users/molek/OneDrive/Desktop/Work/Magic-Upsell/client/components/CreateScript.js"],"names":["React","useState","useRef","useEffect","Toast","Button","useMutation","axios","CREATE_SCRIPT","config","require","getUrl","s","CreateScript","props","isInitialMount","showToast","setToast","message","setMessage","handleSubmit","error","discountError","data","discountData","refresh","setRefresh","toggleToast","toastMarkup","pending","setPending","current","console","log","manual","variables","input","displayScope","src","then","db_data","script_id","ExtractId","scriptTagCreate","scriptTag","id","upsell_mode","put","HTTP_API","valueID","handleRefresh"],"mappings":"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","sourcesContent":["import React, { useState,useRef,useEffect} from 'react';\r\nimport {\r\n  Toast,\r\n  Button,\r\n} from '@shopify/polaris';\r\nimport { useMutation } from 'react-apollo';\r\nimport axios from 'axios';\r\nimport {CREATE_SCRIPT} from '../../server/config/appBasicQuery.js';\r\nconst config = require('../../server/config/httpConfig.js');\r\n\r\nfunction getUrl(s) {\r\n  switch (s) {\r\n    case 'dynamic': return 'https://cdn.shopify.com/s/files/1/0313/1447/7188/files/MagicD-v7.js?v=1600115933';\r\n    case 'manual': return 'https://cdn.shopify.com/s/files/1/0313/1447/7188/files/MagicM-v7.js?v=1600115933';\r\n    default: null;\r\n  }\r\n}\r\n\r\nfunction CreateScript(props) {\r\n  const isInitialMount = useRef(true);\r\n  const [showToast, setToast] = useState(false);\r\n  const [message, setMessage] = useState();\r\n  const [handleSubmit,{error:discountError, data:discountData}] = useMutation(CREATE_SCRIPT);\r\n  const [refresh, setRefresh] = useState(false);\r\n  const toggleToast = () => setToast(!showToast);\r\n  const toastMarkup = showToast ? (\r\n        <Toast content={message} onDismiss={toggleToast} Diduration={1500} />\r\n    ) : null;\r\n  const [pending, setPending] = useState(true);\r\n\r\nuseEffect(() => {\r\nif (isInitialMount.current && props) {\r\n        setPending(false);\r\nisInitialMount.current = false;\r\nconsole.log('sss',props)\r\n      }\r\n\r\n});\r\n\r\n  return (\r\n<>\r\n{!pending ?\r\n    <div>\r\n      {toastMarkup}\r\n      <Button\r\n      disabled={!props.manual[2]}\r\n      primary\r\n      onClick = {() => {\r\n        handleSubmit({\r\n          variables:{\r\n            input:{\r\n              displayScope: 'ORDER_STATUS',\r\n              src:getUrl(props.manual[1])\r\n            }\r\n          }\r\n        }).then(async ({data})=>{\r\n          setMessage('Successfully Installed!');\r\n          toggleToast();\r\n          const db_data = {script_id: config.ExtractId(data.scriptTagCreate.scriptTag.id),upsell_mode:props.manual[1]};\r\n          await axios.put(config.HTTP_API + '/store/' + props.valueID, db_data);\r\n          props.handleRefresh();\r\n        });\r\n      }}>Activate</Button>\r\n    </div>\r\n:\r\nnull\r\n}\r\n</>\r\n  );\r\n}\r\nexport default CreateScript;\r\n"]},"metadata":{},"sourceType":"module"}